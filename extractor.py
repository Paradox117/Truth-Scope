from keybert import KeyBERT

kw_model = KeyBERT('all-mpnet-base-v2')


def extract_guided_keywords(article_text, seed_words=['economy', 'inflation', 'budget', 'GDP', 'investment', 'startup', 'rupee', 'RBI', 'election', 'coalition', 'manifesto', 'democracy', 'parliament', 'governance', 'monsoon', 'climate', 'pollution', 'sustainability', 'renewable', 'carbon', 'technology', 'artificial intelligence', 'digital', 'cybersecurity', 'UPI', '5G', 'healthcare', 'vaccine', 'pandemic', 'telemedicine', 'hospital', 'insurance', 'education', 'NEP', 'university', 'online learning', 'skill development', 'cricket', 'Olympics', 'athlete', 'tournament', 'championship', 'Bollywood', 'OTT', 'cinema', 'streaming', 'box office', 'diplomacy', 'bilateral', 'security', 'trade agreement', 'defense', 'infrastructure', 'metro', 'smart city', 'housing', 'urbanization', 'supreme court', 'legislation', 'verdict', 'amendment', 'judicial', 'agriculture', 'farmer', 'crop', 'MSP', 'food security', 'unemployment', 'workforce', 'labor', 'migration', 'industry', 'stock market', 'interest rate', 'fiscal deficit', 'taxation', 'GST', 'military', 'border', 'strategic', 'defense deal', 'naval', 'vaccination', 'medical research', 'virus', 'corruption', 'transparency', 'accountability', 'lokpal', 'vigilance', 'entrepreneur', 'funding', 'innovation', 'venture capital', 'ecommerce', 'terrorism', 'internal security', 'intelligence', 'extremism', 'border security', 'reservation', 'social justice', 'inclusion', 'minority', 'affirmative action', 'water crisis', 'river linking', 'groundwater', 'dam', 'irrigation', 'cryptocurrency', 'fintech', 'digital payment', 'banking', 'financial inclusion', 'tourism', 'heritage', 'wildlife', 'ecotourism', 'hospitality', 'space program', 'satellite', 'ISRO', 'mission', 'aerospace', 'transport', 'electric vehicle', 'highway', 'railway', 'aviation', 'government', 'policy', 'minister', 'regulation', 'reform', 'leadership', 'dissent', 'debate', 'opposition', 'constituency', 'campaign', 'administration', 'judiciary', 'federal', 'state', 'finance', 'market', 'trade', 'fiscal', 'tax', 'commerce', 'manufacturing', 'economic', 'recession', 'recovery', 'growth', 'jobs', 'union', 'road', 'construction', 'urban', 'development', 'realestate', 'robotics', 'blockchain', 'automation', 'internet', 'application', 'software', 'hardware', 'telecom', 'mobile', 'research', 'science', 'laboratory', 'discovery', 'astrophysics', 'quantum', 'nuclear', 'energy', 'solar', 'wind', 'biofuel', 'conservation', 'biodiversity', 'green', 'ecology', 'treatment', 'medicine', 'doctor', 'care', 'wellness', 'nutrition', 'disease', 'mental', 'therapy', 'fitness', 'match', 'coach', 'IPL', 'score', 'record', 'event', 'training', 'film', 'actor', 'actress', 'drama', 'music', 'celebrity', 'festival', 'review', 'award', 'art', 'theatre', 'culture', 'literature', 'dance', 'reality', 'show', 'school', 'curriculum', 'exam', 'scholarship', 'learning', 'classroom', 'teacher', 'pedagogy', 'community', 'activism', 'protest', 'rights', 'equality', 'election reforms', 'coalition government', 'federalism', 'judicial activism', 'anti-corruption', 'reservation policy', 'caste dynamics', 'minority rights', 'border disputes', 'national security', 'diplomatic relations', 'RTI activism', 'GST reforms', 'inflation trends', 'FDI inflows', 'MSME sector', 'agricultural GDP', 'startup ecosystem', 'unicorn valuations', 'rural entrepreneurship', 'formalization push', 'skill gap', 'gig economy', 'PPP projects', 'AI governance', 'semiconductor push', 'deep-tech startups', 'data localization', 'edtech adoption', 'drone regulations', '6G readiness', 'coal dependency', 'air quality', 'water scarcity', 'climate resilience', 'solar adoption', 'EV infrastructure', 'carbon markets', 'Himalayan ecology', 'coastal erosion', 'waste management', 'green hydrogen', 'gender equality', 'urban migration', 'farmer distress', 'healthcare access', 'digital divide', 'religious harmony', 'mental health', 'ageing population', 'nutrition schemes', 'tribal rights', 'sanitation drive', 'rural unemployment', 'Bollylywood trends', 'OTT censorship', 'cricket economy', 'yoga diplomacy', 'religious tourism', 'regional cinema', 'fusion cuisine', 'fast fashion', 'matrimonial apps', 'vernacular content', 'heritage conservation', 'festival economy', 'IIT placements', 'STEM initiatives', 'global rankings', 'reservation in education', 'philanthropic funding', 'academic collaborations', 'rural literacy', 'EdTech mergers', 'port modernization', 'rural electrification', 'logistics network', 'optical fiber', 'warehousing boom', 'transit-oriented development', 'organic farming', 'crop insurance', 'warehouse receipts', 'agri-tech', 'fertilizer subsidies', 'food processing', 'land leasing', 'drought mitigation', 'farmer producer organizations', 'soil health', 'SAARC relations', 'diaspora engagement', 'Indo-Pacific strategy', 'strategic autonomy', 'defense exports', 'soft power', 'remittance flows', 'global south', 'climate negotiations', 'dollar-rupee dynamics', 'energy diplomacy', 'privacy laws', 'cybercrime', 'consumer rights', 'land acquisition', 'IPR disputes', 'marriage laws', 'free speech', 'right to education', 'refugee policy', 'surrogacy laws', 'anticipatory bail']):
    """
    This function extracts keywords using the guided KeyBERT method with seeded keyword list

    Args: 
        article_text(str): the content (here it is specialised for news)
        seed_words(list): list of important words related to news (seed)
    Returns:
        keywords (list): list of extracted keywords
    """
    
    keywords = kw_model.extract_keywords(article_text,keyphrase_ngram_range=(1,3), stop_words='english', highlight=False, top_n=10, use_maxsum=True, nr_candidates=20, seed_keywords=seed_words)
    return [keyword for keyword, score in keywords]

#sample
article_text = """
The text goes here
"""
extracted_keywords = extract_guided_keywords(article_text)
print(extracted_keywords)